<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dragomir's Weather</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">

<style>
  body {
    font-family: 'Inter', sans-serif;
    background: linear-gradient(135deg, #0a0f1c 0%, #0d1224 50%, #0b162e 100%);
    color: #e5e7eb;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding: 1rem;
    overflow-x: hidden;
  }

  /* Animated background shimmer */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: radial-gradient(circle at top, rgba(59,130,246,0.15), rgba(14,165,233,0.05), rgba(17,24,39,1));
    background-size: 200% 200%;
    animation: moveGrad 30s ease-in-out infinite alternate;
    z-index: -1;
  }
  @keyframes moveGrad {
    0% { background-position: 0% 0%; }
    100% { background-position: 100% 100%; }
  }

  .weather-container {
    width: 95%;
    max-width: 1200px;
    background: rgba(15,23,42,0.8);
    border: 1px solid rgba(59,130,246,0.15);
    backdrop-filter: blur(18px);
    border-radius: 2rem;
    box-shadow: 0 0 30px rgba(0,0,0,0.4);
    padding: 2rem 1.5rem;
    margin-top: 2rem;
    position: relative;
    overflow: hidden;
  }

  /* daily cards */
  .daily-card {
    background: rgba(30,41,59,0.8);
    border-radius: 1rem;
    border: 1px solid transparent;
    cursor: pointer;
    transition: all 0.3s ease;
  }
  .daily-card:hover {
    transform: translateY(-3px);
    border-color: #3b82f6;
    box-shadow: 0 5px 20px rgba(59,130,246,0.3);
  }
  .daily-card.active {
    border-color: #3b82f6;
    box-shadow: 0 0 15px rgba(59,130,246,0.5);
  }

  /* hourly section */
  #hourly-detail {
    overflow: hidden;
    transition: all 0.8s cubic-bezier(.4,.2,.2,1);
    max-height: 0;
  }
  #hourly-detail.visible {
    max-height: 650px;
    margin-top: 1.5rem;
  }

  /* Hourly Scrollbar Custom */
  .hourly-scroll {
    overflow-x: auto;
    scroll-behavior: smooth;
    display: flex;
    gap: 0.75rem;
    padding: 1rem 0 1.2rem;
  }

  .hourly-scroll::-webkit-scrollbar {
    height: 8px;
  }
  .hourly-scroll::-webkit-scrollbar-track {
    background: rgba(59,130,246,0.15);
    border-radius: 4px;
  }
  .hourly-scroll::-webkit-scrollbar-thumb {
    background: linear-gradient(90deg, #3b82f6, #06b6d4);
    border-radius: 4px;
    box-shadow: 0 0 10px rgba(59,130,246,0.4);
  }
  .hourly-scroll::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(90deg, #60a5fa, #22d3ee);
  }

  /* hourly card */
  .hourly-card {
    background: rgba(31,41,55,0.75);
    border-radius: 1rem;
    border: 1px solid rgba(55,65,81,0.6);
    text-align: center;
    padding: 0.8rem 0.6rem;
    min-width: 115px;
    transform: scale(0.95);
    opacity: 0;
    animation: slideIn .6s forwards;
  }
  @keyframes slideIn {
    0% { opacity: 0; transform: translateY(20px) scale(0.9); }
    100% { opacity: 1; transform: translateY(0) scale(1); }
  }
  .hourly-card:hover {
    background: rgba(59,130,246,0.2);
    transform: translateY(-3px) scale(1.03);
  }

  /* glowing temperature line */
  .temp-bar {
    height: 4px;
    background: linear-gradient(90deg,#3b82f6,#06b6d4);
    border-radius: 2px;
    margin-top: 6px;
    animation: pulseGlow 3s ease-in-out infinite;
  }
  @keyframes pulseGlow {
    0%,100% { opacity: .6; }
    50% { opacity: 1; }
  }

  .spinner {
    border: 4px solid rgba(59,130,246,0.2);
    border-top: 4px solid #3b82f6;
    border-radius: 50%;
    width: 40px;
    height: 40px;
    animation: spin 1s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }
</style>
</head>

<body>
<div class="weather-container">
  <header class="text-center mb-6">
    <h1 class="text-4xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-blue-400 via-sky-400 to-cyan-300">Northampton, UK</h1>
    <p class="text-gray-400 mt-2 text-sm sm:text-base">Real-Time 7-Day Forecast Dashboard</p>
  </header>

  <div id="daily-forecast-output" class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6">
    <div id="loading" class="col-span-5 flex justify-center items-center py-12">
      <div class="spinner"></div>
      <span class="ml-4 text-gray-400">Fetching forecast...</span>
    </div>
  </div>

  <div id="hourly-detail">
    <h2 id="hourly-title" class="text-lg font-bold text-blue-300 mb-2 px-2"></h2>
    <div id="hourly-output" class="hourly-scroll"></div>
  </div>

  <footer class="text-center text-xs text-gray-600 mt-8 pt-4 border-t border-gray-800">
    Powered by Dragomir's API.
  </footer>
</div>

<script>
const LAT=52.2405, LON=-0.8970;
const API=`https://api.open-meteo.com/v1/forecast?latitude=${LAT}&longitude=${LON}&daily=weather_code,temperature_2m_max,temperature_2m_min,sunrise,sunset&hourly=temperature_2m,weather_code,precipitation&forecast_days=7&timezone=Europe%2FLondon`;
let all=null;

function iconFor(code,isDay=true){
  let d="Clouds",p="",c=isDay?"text-yellow-400":"text-indigo-300";
  switch(true){
    case [0].includes(code):d="Clear";p="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M12 8a4 4 0 1 0 0 8";break;
    case [1,2].includes(code):d="Partly Cloudy";p="M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z";c="text-gray-400";break;
    case [3].includes(code):d="Overcast";p="M18 10h-1.26a8 8 0 1 0-16.3 0";c="text-gray-500";break;
    case [51,53,55,61,63,65,80,81,82].includes(code):d="Rain";p="M12 18v3M6.5 17.5l-1.5 1.5M17.5 17.5l1.5 1.5M22 10a7 7 0 0 0-14 0 5 5 0 0 0-5 5h17Z";c="text-blue-400";break;
    case [71,73,75,77,85,86].includes(code):d="Snow";p="M12 18v3M8 17.5l-1-1M16 17.5l1 1M22 10a7 7 0 0 0-14 0 5 5 0 0 0-5 5h17Z";c="text-cyan-300";break;
    case [95,96,99].includes(code):d="Storm";p="M12 2v8h4l-4 8v-8h-4l4-8z";c="text-red-400";break;
  }
  const s=`<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="${c} mx-auto"><path d="${p}"/></svg>`;
  return {d,s};
}

async function fetchWeather(){
  const r=await fetch(API);
  all=await r.json();
  renderDaily(all);
  showHourly(0);
}

function renderDaily(d){
  const out=document.getElementById('daily-forecast-output');
  out.innerHTML='';
  for(let i=0;i<7;i++){
    const date=new Date(d.daily.time[i]);
    const {d:desc,s}=iconFor(d.daily.weather_code[i]);
    const max=Math.round(d.daily.temperature_2m_max[i]);
    const min=Math.round(d.daily.temperature_2m_min[i]);
    const card=document.createElement('div');
    card.className='daily-card p-4 flex flex-col items-center justify-between text-center';
    card.dataset.day=i;
    card.innerHTML=`
      <p class="font-semibold text-sm ${i===0?'text-blue-400':'text-gray-300'}">${i===0?'Today':date.toLocaleDateString('en-GB',{weekday:'short'})}</p>
      <p class="text-xs text-gray-500">${date.toLocaleDateString('en-GB',{day:'numeric',month:'short'})}</p>
      <div class="my-2">${s}</div>
      <div class="text-lg font-bold"><span class="text-blue-300">${max}°</span>/<span class="text-gray-400">${min}°</span></div>
      <p class="text-xs text-gray-400 mt-1">${desc}</p>`;
    card.onclick=()=>showHourly(i);
    out.appendChild(card);
  }
}

function showHourly(i){
  const detail=document.getElementById('hourly-detail');
  const output=document.getElementById('hourly-output');
  const title=document.getElementById('hourly-title');
  document.querySelectorAll('.daily-card').forEach(c=>c.classList.remove('active'));
  const act=document.querySelector(`[data-day="${i}"]`);
  if(act)act.classList.add('active');
  const hr=all.hourly;
  const start=i*24,end=start+24;
  const sunrise=new Date(all.daily.sunrise[i]);
  const sunset=new Date(all.daily.sunset[i]);
  title.textContent=`Hourly Forecast — ${new Date(all.daily.time[i]).toLocaleDateString('en-GB',{weekday:'long',day:'numeric',month:'long'})}`;
  output.innerHTML='';
  hr.time.slice(start,end).forEach((t,idx)=>{
    const time=new Date(t);
    const isDay=time>sunrise&&time<sunset;
    const {d,s}=iconFor(hr.weather_code[start+idx],isDay);
    const temp=Math.round(hr.temperature_2m[start+idx]);
    const prec=hr.precipitation[start+idx].toFixed(1);
    const card=document.createElement('div');
    card.className='hourly-card';
    card.style.animationDelay=`${idx*0.04}s`;
    card.innerHTML=`
      <p class="text-sm font-semibold ${isDay?'text-yellow-300':'text-indigo-300'}">${time.getHours().toString().padStart(2,'0')}:00</p>
      <div class="mt-1">${s}</div>
      <p class="text-xl font-bold text-blue-200 mt-1">${temp}°C</p>
      <p class="text-xs text-gray-400 mt-1">${d}</p>
      <p class="text-xs text-cyan-300 mt-1">${prec} mm</p>
      <div class="temp-bar"></div>`;
    output.appendChild(card);
  });
  detail.classList.add('visible');
}

window.onload=fetchWeather;
</script>
</body>
</html>
